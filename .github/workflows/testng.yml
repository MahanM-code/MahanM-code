
# WHEN YOU RUN THE CODE LOCALLY BUT HEADLESS THEN USE THE BELOW YAML

# name: Run TestNG Tests

# on:
#   push:
#     branches: [ main ]
#   pull_request:
#     branches: [ main ]
#   workflow_dispatch:

# jobs:
#   test:
#     runs-on: ubuntu-latest

#     steps:
#       - name: Checkout Code
#         uses: actions/checkout@v3

#       - name: Set up Java
#         uses: actions/setup-java@v3
#         with:
#           distribution: 'temurin'
#           java-version: '17'

#       - name: Build Project
#         run: mvn clean install -DskipTests

#       - name: Run TestNG Tests
#         run: mvn clean test -Dci=true -Dsurefire.suiteXmlFiles=testng.xml

#       - name: Upload TestNG Reports
#         uses: actions/upload-artifact@v4
#         with:
#           name: TestNG-Reports
#           path: test-output/
#           retention-days: 7


# When you run the code on the Remote like Selenium grid, docker and kubernetes use the below yaml

name: Run Selenium Grid Tests

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    services:
      selenium:
        image: selenium/standalone-chrome:latest
        ports:
          - 4444:4444
        options: >-
          --shm-size="2g"

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Set up Java
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'

      - name: Wait for Selenium Grid
        run: |
          echo "Waiting for Grid..."
          sleep 15

      - name: Run Tests on Grid
        run: mvn clean test -Dexecution=remote -Dbrowser=chrome
      - name: Check Grid Status
        run: curl http://localhost:4444/status 
